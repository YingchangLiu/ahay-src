\section{Examples}

I illustrate the anisotropic wave-mode separation with a simple fold
synthetic example and a more challenging model based on the elastic
Marmousi II model~\cite[]{marmousi}. I then show the wave-mode
separation for a 3D TTI model.


\subsection{2D TTI fold model}
\inputdir{fold}
Consider the 2D fold model shown in 
\rFg{fold-vp,vs,ro,epsilon,delta,aoppos}. 
Panels~\rfn{fold-vp}--\subrfn{fold-aoppos} show $V_{P0}$, $V_{S0}$,
density, parameters $\epsilon$, $\delta$, and the local tilts $\nu$ of
the model, respectively. The symmetry axis is orthogonal to the
reflectors throughout the model.
\rFg{rop}
illustrates the separators obtained at different locations in the
model and defined by the intersections of $x$ coordinates $0.15, 0.3,
0.45$~km and $z$ coordinates $0.15, 0.3, 0.45$~km, shown by the dots
in \rFg{aoppos}. Since the operators correspond to different
combinations of the $V_{P0}/V_{S0}$ ratio and parameters $\epsilon$,
$\delta$, and tilt angle $\nu$, they have different forms. However, the
orientation of the operators conform to the corresponding tilts at the
locations shown by the dots in \rFg{aoppos}. For complex models, the
symmetry axes vary spatially, which makes it difficult to rotate the
wavefields to the local symmetry axis directions. Consequently, the
elastic wavefields are reconstructed in untilted Cartesian
coordinates, and when separating wave-modes, I use operators
constructed in conventional Cartesian coordinates. To illustrate the
relationship between the operators and the local tilts, the filters
in \rfg{rop} are projected onto the local symmetry axes and the
orthogonal directions at the filter location. As shown
in \rfg{xdomain.tapered}, the rotated filters (\rfg{dX_rot_TTI}) show
a clearer relation with the tilt angle, while the non-rotated filters
(\rfg{dX_TTI}), which are used in the wave-mode separation, do not
show a clear relation with the tilt angle.


\rFg{uA} shows the vertical and horizontal components of one snapshot
of the simulated elastic anisotropic wavefield; \rfg{pI} shows the
separation into P- and S-modes using divergence and curl
operators; \rfg{pV} shows the separation into {\it q}P and {\it q}S
modes using VTI filters, i.e., assuming zero tilt throughout the
model; and \rfg{pA} shows the separation obtained with the TTI
operators constructed using the local medium parameters with correct
tilts. The isotropic separation shown in \rFg{pI} is incomplete; for
example, at $x=0.4$ km and $z=0.1$ km, and at $ x=0.4$ km and $z=0.35$
km, residuals for direct P and S arrivals are visible in the {\it q}P
and {\it q}S panels, respectively. A comparison of \rfgs{pV}
and \subrfn{pA} indicates that the spatially-varying derivative operators
with correct tilts successfully separate the elastic wavefields into
{\it q}P and {\it q}S modes, while the VTI operators only work in the
part of the model that is locally VTI.
%The separation using VTI filters fails at
%locations where the local dip is large. For example, at coordinates
%$x=0.42$~km and $z=0.1$~km, we see strong S-wave residual in the {\it
%q}P panel; and at coordinates $x=0.02$~km and $z=0.1$~km, we see P
%wave residual in the {\it q}S panel.

% ------------------------------------------------------------
\multiplot{6}{vp,vs,ro,epsilon,delta,aoppos}{width=0.35\textwidth}
{A fold model with parameters (a) $V_{P0}$, (b) $V_{S0}$, (c) density,
(d) $\epsilon$, (e) $\delta$, and (f) tilt angle $\nu$. The dots in
panel (f) correspond to the locations of the anisotropic operators
shown in \rFg{rop}.  }


\plot{rop}
{width=\textwidth} {The TTI wave-mode separation filters projected to
local symmetry axes and their orthogonal directions. Here, I use
$\sigma=1$ in \req{gaussiantaper} to taper the polarization vector
components before the Fourier transform. The filters correspond to the
intersections of $x=0.15$, $0.3$, $0.45$~km and $z=0.15$, $0.3$,
$0.45$~km for the model shown
in \rfg{fold-vp,vs,ro,epsilon,delta,aoppos}. The locations of these
operators are also shown by the dots in \rFg{aoppos}.}
%\multiplot{4}{uA,pI,pV,pA}{width=.45\textwidth}
\multiplot{4}{uA}{width=.45\textwidth}
{(a) A snapshot of the anisotropic wavefield simulated with a vertical
point displacement source at $x=0.3$~km and $z=0.1$~km for the model
shown in {\rfg{fold-vp,vs,ro,epsilon,delta,aoppos}}. Panels (b) to (d)
are the anisotropic {\it q}P and {\it q}S modes separated using
isotropic, VTI, and TTI separators, respectively. The separation is
incomplete in panels (b) and (c) where the model is strongly
anisotropic and where the model tilt is large, respectively. Panel (d)
shows the best separation among all.}
% ------------------------------------------------------------


\subsection{Marmousi II model}
\inputdir{marmousi2}
My second model (\rfg{vp,vs,rx,epsilon,delta,nu}) uses an elastic
anisotropic version of the Marmousi II model~\cite[]{marmousi}. In the
modified model, $V_{P0}$ is taken from the original model
(\rFg{marmousi2-vp}), the $V_{P0}/V_{S0}$ ratio ranges from 2 to 2.5,
(\rFg{marmousi2-vs}), and the density $\rho$ is taken from the
original model (\rFg{marmousi2-rx}). The parameter $\epsilon$ and
$\delta$ are derived from the density model $\rho$ with the relations
of $\epsilon=0.25\rho-0.3$ and $\epsilon=0.125\rho-0.1$,
respectively. The parameter $\epsilon$ ranges from $0.13$ to $0.36$
\rfg{marmousi2-epsilon}, and parameter $\delta$ ranges from $0.11$
to $0.24$ \rfg{marmousi2-delta}. These anisotropy parameters are
obtained by assuming linear relationships to the velocity models, and
therefore, they both follow the structure of the
model. \rfg{marmousi2-nu} represents the local dips obtained from the
density model using plane wave destruction
filters~\cite[]{GEO67-06-19461960}. The dip model is used to simulate
the wavefields and also used to construct TTI separators. A
displacement source oriented at 45$^\circ$ to the vertical direction
and located at coordinates $x=11$~km and $z=1$~km is used to simulate
the elastic anisotropic wavefield.

\rFg{uA-wom} presents one snapshot of the simulated elastic 
wavefields using the anisotropic model shown
in \rfg{marmousi2-vp,vs,rx,epsilon,delta,nu}. \rFgs{iA-wom},
\subrfn{vA-wom}, and \subrfn{pA-wom} demonstrate the separation using conventional 
divergence and curl operators, VTI filters, and correct TTI filters,
respectively. The VTI filters are constructed assuming zero tilt
throughout the model, and the TTI filters are constructed with the
dips used for modeling. As expected, the conventional divergence and
curl operators fail at locations where anisotropy is strong.  For
example, in \rFg{iA-wom} at coordinates $x=12.0$~km and $z=1.0$~km
strong S-wave residual exists, and at coordinates $x=13.0$~km and
$z=1.5$~km strong P-wave residual exists. VTI separators fail at
locations where the dip is large.  For example, in \rFgs{vA-wom} at
coordinates $x=10.0$~km and $z=1.2$~km, strong S-wave residual
exist. However, even for this complicated model, separation using TTI
separators is effective at locations where medium parameters change
rapidly.



%\multiplot{6}{vp,vs,rx,epsilon,delta,nu}{width=0.45\textwidth}{Anisotropic elastic Marmousi II model with (a) $V_{P0}$, (b) $V_{S0}$, (c) density, (d) $\epsilon$, (e) $\delta$, and (f) local tilt angle $\nu$.  }

\multiplot{2}{uA-wom,iA-wom,vA-wom,pA-wom}{width=.45\textwidth}
{(a) A snapshot of the vertical and horizontal displacement wavefield
simulated for model shown
in \rFg{marmousi2-vp,vs,rx,epsilon,delta,nu}.  Panels (b) to (c) are
the P- and SV-wave separation using $\DIV{}$ and $\CURL{}$, VTI
separators and TTI separators, respectively. The separation is
incomplete in panels (b) and (c) where the model is strongly
anisotropic and where the model tilt is large, respectively. Panel (d)
shows the best separation among all.}


\subsection{3D TTI model}
I use a homogeneous TTI model to illustrate the separation of P-,
SV-, and SH-modes. The model has parameters $V_{P0}=3.5$~km/s,
$V_{S0}=1.75$~km/s, $\rho=2.0$~g/cm$^3$, $\epsilon=0.4$, $\delta=0.1$,
$\gamma=0.0$, $\nu=30^\circ$, and
$\alpha=45^\circ$. \rFg{we3d-0,we3d-1,we3d-2} shows a snapshot of the
elastic wavefields in the $z$, $x$, and $y$ directions. A displacement
source located at the center of the model and oriented at tilt
45$^\circ$ and azimuth 45$^\circ$ is used to excite the
wavefield. \rFg{P,SH,SV} shows successfully separated P-, SV-, and
SH-modes. In this model, the parameter $\gamma$, which characterizes
the anisotropy of SH-mode, is set to zero so that the SH-mode
propagation is isotropic. For this homogeneous model, a spherical
wavefront in the SH-panel indicates successful separation of SV- and
SH-modes.

Because this model is homogeneous, the separation is implemented in
the wavenumber domain to reduce computation cost. For heterogeneous
models, 3D non-stationary filtering is necessary to separate different
wave-modes. I do not perform wave-mode separation in 3D heterogeneous
models because of the high computational cost, which will be discussed
in more detail in the following section.




\inputdir{tti3}
\multiplot{2}{we3d-0,we3d-1,we3d-2}{width=.45\textwidth}
{A snapshot of the elastic wavefield in the $z$, $x$ and $y$
directions for a 3D VTI model. The model has parameters
$V_{P0}=3.5$~km/s, $V_{S0}=1.75$~km/s, $\rho=2.0$~g/cm$^3$,
$\epsilon=0.4$, $\delta=0.1$, and $\gamma=0.0$.  A displacement source
oriented at 45$^\circ$ to the vertical direction and located at
coordinates $x=11$~km and $z=1$~km is used to simulate the elastic
anisotropic wavefield.  }

\multiplot{2}{P,SH,SV}{width=.45\textwidth}
{Separated P-, SV- and SH-wave-modes for the elastic wavefields shown in
\rFg{tti3-we3d-0,we3d-1,we3d-2}.
P, SV, and SH are well separated from each other.}

% ------------------------------------------------------------
